FROM node:20-slim

WORKDIR /app

COPY package.json pnpm-lock.yaml* ./
RUN npm install -g pnpm
RUN pnpm install

COPY . .

# Compila tu proyecto Astro para producci칩n
RUN pnpm build

# Exp칩n el puerto que usar치 Cloud Run (siempre ser치 8080)
EXPOSE 8080

# Usa "preview" para servir el sitio generado
CMD ["pnpm", "preview", "--port", "8080", "--host"]
